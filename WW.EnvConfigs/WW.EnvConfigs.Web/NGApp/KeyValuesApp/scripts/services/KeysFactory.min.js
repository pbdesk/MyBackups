(function(){"use strict";function n(n,t){var r="/api/Keys/",i=[],u=!1,f=function(){return u},e=function(f,e){var o=t.defer(),s="KeysCache"+f;return sessionStorage.getItem(s)&&!e?(angular.copy(angular.fromJson(sessionStorage.getItem(s)),i),u=!0,o.resolve(i)):n.get(r+f).then(function(n){var t=PBDeskJS.Utils.ResolveReferences(n.data);$.each(t,function(n,t){t.WWFramework&&(t.WWFramework.EnvKeys=null,t.WWFramework.WWApps=null)});angular.copy(t,i);sessionStorage.setItem(s,angular.toJson(i));u=!0;o.resolve(i)},function(){o.reject()}),o.promise},o=function(n){if(f()==!0){var t=$.grep(i,function(t){return t.Id==n});return t.length==0?null:t.length==1?t[0]:null}return null},s=function(u){var f=t.defer();return n.post(r,u).then(function(n){var t=n.data;i.splice(0,0,t);f.resolve(t)},function(){f.reject()}),f.promise},h=function(u){var f=t.defer();return n.put(r+u.Id,u).then(function(n){var t=n.data,r=$.grep(i,function(n){return n.Id==t.Id});angular.copy(t,r[0]);f.resolve(t)},function(){f.reject()}),f.promise};return{Keys:i,GetKeys:e,GetKey:o,IsReady:f,CreateKey:s,UpdateKey:h}}angular.module(KeyValuesAppName).factory("KeysFactory",["$http","$q",n])})();